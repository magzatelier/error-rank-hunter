<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chapter 1 | Your Story Title</title>
  
  <!-- Styles -->
  <link rel="stylesheet" href="../css/base.css">
  <link rel="stylesheet" href="../css/components.css">
  
  <!-- Settings Script -->
  <script src="../js/settings.js"></script>
  
  <style>
    /* Chapter 1 - Pure black background during popups */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    html, body {
      background-color: #000;
      min-height: 100vh;
      margin: 0;
      padding: 0;
      overflow-x: hidden;
    }
    
    /* Header hidden during popup sequence */
    .site-header {
      opacity: 0;
      transition: opacity 0.5s ease;
    }
    
    .site-header.is-visible {
      opacity: 1;
    }
    
    /* Main content hidden during popup sequence */
    .chapter-end-content {
      opacity: 0;
      transition: opacity 0.5s ease;
      display: none;
    }
    
    .chapter-end-content.is-visible {
      display: block;
      opacity: 1;
    }
    
    /* End of chapter styling */
    .chapter-end {
      max-width: 600px;
      margin: 0 auto;
      padding: 100px 2rem 4rem;
      text-align: center;
    }
    
    .chapter-end-title {
      font-family: 'Georgia', serif;
      font-size: 1.5rem;
      letter-spacing: 0.2em;
      color: rgba(255, 255, 255, 0.6);
      margin-bottom: 1rem;
    }
    
    .chapter-end-subtitle {
      font-size: 0.9rem;
      color: rgba(255, 255, 255, 0.3);
      font-style: italic;
      margin-bottom: 3rem;
    }
    
    .chapter-nav {
      display: flex;
      justify-content: center;
      gap: 1rem;
    }
    
    .chapter-nav-btn {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.75rem 1.5rem;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: rgba(255, 255, 255, 0.7);
      text-decoration: none;
      font-size: 0.9rem;
      transition: all 0.2s ease;
    }
    
    .chapter-nav-btn:hover {
      background: rgba(255, 255, 255, 0.1);
      color: #fff;
      text-decoration: none;
    }
    
    .chapter-nav-btn svg {
      width: 16px;
      height: 16px;
    }
    
    /* Override popup backdrop to pure black */
    .popup-backdrop {
      background-color: #000 !important;
    }
    
    /* Force popup centering */
    .popup {
      position: fixed !important;
      top: 50% !important;
      left: 50% !important;
      transform: translate(-50%, -50%) !important;
      margin: 0 !important;
    }
    
    .popup.is-visible {
      transform: translate(-50%, -50%) !important;
    }
  </style>
</head>
<body>
  
  <!-- Header (hidden during sequence) -->
  <header class="site-header">
    <div class="header-inner">
      <a href="../index.html" class="site-title" style="color: #fff;">Your Story Title</a>
    </div>
  </header>

  <!-- Content shown after sequence ends -->
  <main class="chapter-end-content" id="chapter-end">
    <div class="chapter-end">
      <h1 class="chapter-end-title">CHAPTER 1</h1>
      <p class="chapter-end-subtitle">[End of recovered system logs]</p>
      
      <nav class="chapter-nav">
        <a href="../index.html" class="chapter-nav-btn">
          Table of Contents
        </a>
        <a href="chapter-002-forum.html" class="chapter-nav-btn">
          Next Chapter
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="9 18 15 12 9 6"></polyline>
          </svg>
        </a>
      </nav>
    </div>
  </main>

  <!-- Popup System -->
  <script src="../js/popup-system.js"></script>
  
  <script>
    // ============================================================
    // CHAPTER 1 - SYSTEM MANAGEMENT POPUP SEQUENCE
    // ============================================================
    
    document.addEventListener('DOMContentLoaded', function() {
      
      // Helper: System popup with blue border
      function systemPopup(content, hasClose = true) {
        return {
          type: 'html',
          content: `
            <div style="
              font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
              background: linear-gradient(135deg, #0a0a15 0%, #0d0d18 100%);
              border: 1px solid #4a9eff;
              box-shadow: 0 0 20px rgba(74, 158, 255, 0.3);
              padding: 1.25rem 1.5rem;
              color: #e0e0e0;
              text-align: left;
              min-width: 300px;
              max-width: 450px;
              font-size: 0.9rem;
              line-height: 1.6;
            ">
              ${content}
              ${hasClose ? '<div style="text-align: right; margin-top: 0.75rem; color: #4a9eff; font-size: 0.8rem;">[CLOSE]</div>' : ''}
            </div>
          `
        };
      }
      
      // Helper: Error popup with red border
      function errorPopup(content) {
        return {
          type: 'html',
          content: `
            <div style="
              font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
              background: linear-gradient(135deg, #150a0a 0%, #180d0d 100%);
              border: 1px solid #ff4a4a;
              box-shadow: 0 0 20px rgba(255, 74, 74, 0.3);
              padding: 1.25rem 1.5rem;
              color: #ff6b6b;
              text-align: left;
              min-width: 300px;
              max-width: 450px;
              font-size: 0.9rem;
            ">
              ${content}
            </div>
          `
        };
      }
      
      // Helper: Glitchy text
      function glitchPopup(content) {
        return {
          type: 'html',
          content: `
            <div style="
              font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
              background: linear-gradient(135deg, #0a0a15 0%, #0d0d18 100%);
              border: 1px solid #4a9eff;
              box-shadow: 0 0 20px rgba(74, 158, 255, 0.3);
              padding: 1.25rem 1.5rem;
              color: #e0e0e0;
              text-align: left;
              min-width: 300px;
              max-width: 450px;
              font-size: 0.9rem;
            ">
              <div style="text-shadow: 1px 0 #ff0000, -1px 0 #00ff00;">
                ${content}
              </div>
            </div>
          `
        };
      }

      // The full popup sequence
      const sequence = [
        // User Status: CRITICAL
        systemPopup(`
          <div style="color: #4a9eff; font-size: 0.75rem; margin-bottom: 0.5rem;">User Status: CRITICAL</div>
          <div style="margin: 0.5rem 0;"><span style="color: #ff4a4a;">HP: 31/4,892</span></div>
          <div>Condition: <span style="color: #ff4a4a;">Terminal</span></div>
        `),
        
        // Global Status
        systemPopup(`
          <div style="color: #4a9eff; font-size: 0.75rem; margin-bottom: 0.5rem;">System Management</div>
          <div style="margin: 0.4rem 0;">Global Status: <span style="color: #ff4a4a;">COLLAPSED</span></div>
          <div style="margin: 0.4rem 0;">Remaining Survivors: <span style="color: #ffcc00;">1</span></div>
          <div style="margin: 0.4rem 0;">Remaining Habitable Zones: <span style="color: #ff4a4a;">0</span></div>
          <div style="margin-top: 0.75rem; color: #ff4a4a;">Time Until Extinction Event Completion: 00:04:12</div>
        `),
        
        // HP dropping
        systemPopup(`
          <div style="color: #4a9eff; font-size: 0.75rem; margin-bottom: 0.5rem;">User Status: CRITICAL</div>
          <div style="margin: 0.5rem 0;"><span style="color: #ff4a4a;">HP: 14/4,892</span></div>
          <div>Condition: <span style="color: #ff4a4a;">Terminal</span></div>
          <div style="margin-top: 0.75rem; color: #ff4a4a;">Time Remaining: 00:03:58</div>
        `),
        
        // Accessing protocols
        { type: 'html', content: `<div style="font-family: monospace; color: #4a9eff; padding: 1rem;">Accessing emergency protocols…</div>` },
        
        // No protocols
        errorPopup(`ERROR: No emergency protocols exist for this situation.`),
        
        // Anomalous input
        systemPopup(`
          <div style="color: #4a9eff; font-size: 0.75rem; margin-bottom: 0.5rem;">System Management</div>
          <div style="margin: 0.4rem 0;">Anomalous input detected.</div>
          <div style="margin: 0.4rem 0;">Source: <span style="color: #ffcc00;">UNKNOWN</span></div>
          <div>Classification: <span style="color: #666;">—</span></div>
        `, false),
        
        // Final requests?
        systemPopup(`
          <div style="color: #4a9eff; font-size: 0.75rem; margin-bottom: 0.5rem;">System Management</div>
          <div style="margin: 0.75rem 0;">Final requests?</div>
          <div style="display: flex; gap: 0.75rem; margin-top: 0.75rem;">
            <span style="border: 1px solid #4a9eff; padding: 0.2rem 0.75rem; color: #4a9eff;">[YES]</span>
            <span style="border: 1px solid #4a9eff; padding: 0.2rem 0.75rem; color: #4a9eff;">[NO]</span>
          </div>
        `, false),
        
        systemPopup(`<div>Response received: <span style="color: #4a9eff;">[NO]</span></div>`),
        
        // Final requests again
        systemPopup(`
          <div style="color: #4a9eff; font-size: 0.75rem; margin-bottom: 0.5rem;">System Management</div>
          <div style="margin: 0.75rem 0;">Final requests?</div>
          <div style="display: flex; gap: 0.75rem; margin-top: 0.75rem;">
            <span style="border: 1px solid #4a9eff; padding: 0.2rem 0.75rem; color: #4a9eff;">[YES]</span>
            <span style="border: 1px solid #4a9eff; padding: 0.2rem 0.75rem; color: #4a9eff;">[NO]</span>
          </div>
        `, false),
        
        systemPopup(`<div>Response received: <span style="color: #4a9eff;">[NO]</span></div>`),
        
        // Third time
        systemPopup(`
          <div style="color: #4a9eff; font-size: 0.75rem; margin-bottom: 0.5rem;">System Management</div>
          <div style="margin: 0.75rem 0;">Final requests?</div>
          <div style="display: flex; gap: 0.75rem; margin-top: 0.75rem;">
            <span style="border: 1px solid #4a9eff; padding: 0.2rem 0.75rem; color: #4a9eff;">[YES]</span>
            <span style="border: 1px solid #4a9eff; padding: 0.2rem 0.75rem; color: #4a9eff;">[NO]</span>
          </div>
        `, false),
        
        // Errors
        errorPopup(`ERROR: Prompt already answered.`),
        errorPopup(`ERROR: Prompt already answered.`),
        errorPopup(`ERROR: Prompt already answered.`),
        
        // Searching
        systemPopup(`
          <div style="color: #4a9eff; font-size: 0.75rem; margin-bottom: 0.5rem;">System Management</div>
          <div>Searching for alternatives...</div>
        `, false),
        
        // Status
        systemPopup(`
          <div style="margin: 0.4rem 0;">Remaining Survivors: <span style="color: #ffcc00;">1</span></div>
          <div style="margin: 0.4rem 0;"><span style="color: #ff4a4a;">HP: 2/4,892</span></div>
          <div style="margin: 0.4rem 0;">Remaining Allies: <span style="color: #ff4a4a;">0</span></div>
          <div style="margin: 0.4rem 0;">Remaining Resources: <span style="color: #ff4a4a;">0</span></div>
          <div style="margin: 0.4rem 0; color: #666;">None found.</div>
          <div style="margin-top: 0.75rem; color: #ff4a4a;">Time Remaining: 00:00:51</div>
        `, false),
        
        // Generating
        systemPopup(`
          <div style="color: #4a9eff; font-size: 0.75rem; margin-bottom: 0.5rem;">System Management</div>
          <div>Generating options...</div>
        `, false),
        
        // Rebirth option
        systemPopup(`
          <div style="margin: 0.5rem 0;">Option generated: <span style="color: #ffcc00;">Rebirth</span></div>
          <div style="display: flex; gap: 0.75rem; margin-top: 0.75rem;">
            <span style="border: 1px solid #4a9eff; padding: 0.2rem 0.75rem; color: #4a9eff;">[ACCEPT]</span>
            <span style="border: 1px solid #4a9eff; padding: 0.2rem 0.75rem; color: #4a9eff;">[DECLINE]</span>
          </div>
        `, false),
        
        errorPopup(`ERROR: User did not request options.`),
        
        // Rebirth again
        systemPopup(`
          <div style="margin: 0.5rem 0;">Option generated: <span style="color: #ffcc00;">Rebirth</span></div>
          <div style="display: flex; gap: 0.75rem; margin-top: 0.75rem;">
            <span style="border: 1px solid #4a9eff; padding: 0.2rem 0.75rem; color: #4a9eff;">[ACCEPT]</span>
            <span style="border: 1px solid #4a9eff; padding: 0.2rem 0.75rem; color: #4a9eff;">[DECLINE]</span>
          </div>
        `, false),
        
        systemPopup(`<div>Response received: <span style="color: #4a9eff;">[DECLINE]</span></div>`),
        
        // Third time
        systemPopup(`
          <div style="margin: 0.5rem 0;">Option generated: <span style="color: #ffcc00;">Rebirth</span></div>
          <div style="display: flex; gap: 0.75rem; margin-top: 0.75rem;">
            <span style="border: 1px solid #4a9eff; padding: 0.2rem 0.75rem; color: #4a9eff;">[ACCEPT]</span>
            <span style="border: 1px solid #4a9eff; padding: 0.2rem 0.75rem; color: #4a9eff;">[DECLINE]</span>
          </div>
        `, false),
        
        systemPopup(`<div>Response received: <span style="color: #4a9eff;">[DECLINE]</span></div>`),
        
        // Blank buttons
        systemPopup(`
          <div style="margin: 0.5rem 0;">Option generated: <span style="color: #ffcc00;">Rebirth</span></div>
          <div style="display: flex; gap: 0.75rem; margin-top: 0.75rem;">
            <span style="border: 1px solid #444; padding: 0.2rem 0.75rem; color: #444;">[    ]</span>
            <span style="border: 1px solid #444; padding: 0.2rem 0.75rem; color: #444;">[    ]</span>
          </div>
        `, false),
        
        errorPopup(`ERROR: Response not registering.`),
        errorPopup(`ERROR: Response not—`),
        
        // HP critical
        systemPopup(`
          <div style="color: #4a9eff; font-size: 0.75rem; margin-bottom: 0.5rem;">User Status: CRITICAL</div>
          <div style="margin: 0.5rem 0;"><span style="color: #ff4a4a;">HP: 2/4,892</span></div>
          <div style="color: #ff4a4a;">Time Remaining: 00:00:41</div>
        `),
        
        errorPopup(`ERROR: [CLOSE] not responding.`),
        errorPopup(`ERROR: [CLOSE] not responding.`),
        errorPopup(`ERROR: [CLOSE] not responding.`),
        
        // Request required
        systemPopup(`
          <div style="color: #4a9eff; font-size: 0.75rem; margin-bottom: 0.5rem;">System Management</div>
          <div style="margin: 0.5rem 0;">Request required to proceed.</div>
          <div style="border: 1px solid #444; padding: 0.2rem 0.75rem; color: #444; display: inline-block; margin-top: 0.5rem;">[    ]</div>
        `, false),
        
        systemPopup(`
          <div style="color: #4a9eff; font-size: 0.75rem; margin-bottom: 0.5rem;">System Management</div>
          <div style="margin: 0.5rem 0;">Request required to proceed.</div>
          <div style="border: 1px solid #444; padding: 0.2rem 0.75rem; color: #444; display: inline-block; margin-top: 0.5rem;">[    ]</div>
        `, false),
        
        glitchPopup(`
          <div>Request required to proc</div>
          <div style="border: 1px solid #444; padding: 0.2rem 0.75rem; color: #444; display: inline-block; margin-top: 0.5rem;">[    ]</div>
        `),
        
        // HP: 1
        systemPopup(`
          <div style="color: #4a9eff; font-size: 0.75rem; margin-bottom: 0.5rem;">User Status: CRITICAL</div>
          <div style="margin: 0.5rem 0;"><span style="color: #ff4a4a;">HP: 1/4,892</span></div>
          <div style="color: #ff4a4a;">Time Remaining: 00:00:12</div>
          <div style="border: 1px solid #444; padding: 0.2rem 0.75rem; color: #444; display: inline-block; margin-top: 0.5rem;">[    ]</div>
        `, false),
        
        // The response
        systemPopup(`
          <div style="margin-bottom: 0.5rem;">Response received:</div>
          <div style="color: #7eb8ff; font-style: italic; padding: 0.5rem; border-left: 2px solid #4a9eff;">[I don't want to be alone anymore]</div>
        `, false),
        
        { type: 'html', content: `<div style="font-family: monospace; color: #4a9eff; padding: 1rem;">Processing...</div>` },
        
        // "you won't be"
        { type: 'html', content: `
          <div style="
            font-family: monospace;
            background: linear-gradient(135deg, #0a0a15 0%, #0d0d18 100%);
            border: 1px solid #4a9eff;
            padding: 1.25rem 1.5rem;
            color: #e0e0e0;
            text-align: center;
            min-width: 300px;
          ">
            <div style="color: #4a9eff; font-size: 0.75rem; margin-bottom: 0.5rem;">System Management</div>
            <div style="letter-spacing: 0.2em; color: #7eb8ff;">y ou wo n't be</div>
          </div>
        ` },
        
        // Unauthorized
        { type: 'html', content: `
          <div style="
            font-family: monospace;
            background: linear-gradient(135deg, #0a0a15 0%, #0d0d18 100%);
            border: 1px solid #ff4a4a;
            box-shadow: 0 0 20px rgba(255, 74, 74, 0.3);
            padding: 1.25rem 1.5rem;
            color: #e0e0e0;
            min-width: 300px;
            font-size: 0.9rem;
          ">
            <div style="color: #4a9eff; font-size: 0.75rem; margin-bottom: 0.5rem;">System Management</div>
            <div style="color: #ff4a4a; font-weight: bold; margin: 0.5rem 0;">UNAUTHORIZED PROCESS INITIATED</div>
            <div style="margin: 0.3rem 0;">Protocol: <span style="color: #444;">████████</span></div>
            <div style="margin: 0.3rem 0;">Function: <span style="color: #444;">Temporal ██████</span></div>
            <div style="margin: 0.3rem 0;">Cost: <span style="color: #444;">████</span></div>
          </div>
        ` },
        
        errorPopup(`WARNING: This action violates <span style="color: #444;">███ ██████</span> directives.`),
        errorPopup(`WARNING: This action will alert <span style="color: #444;">████████</span>.`),
        errorPopup(`WARNING: This action—`),
        
        // Override
        { type: 'html', content: `
          <div style="
            font-family: monospace;
            background: linear-gradient(135deg, #0a150a 0%, #0d180d 100%);
            border: 1px solid #4aff4a;
            box-shadow: 0 0 20px rgba(74, 255, 74, 0.3);
            padding: 1.25rem 1.5rem;
            color: #4aff4a;
            text-align: center;
            font-weight: bold;
            min-width: 300px;
          ">
            [OVERRIDE]
          </div>
        ` },
        
        { type: 'html', content: `
          <div style="
            font-family: monospace;
            background: linear-gradient(135deg, #0a150a 0%, #0d180d 100%);
            border: 1px solid #4aff4a;
            box-shadow: 0 0 20px rgba(74, 255, 74, 0.3);
            padding: 1.25rem 1.5rem;
            color: #4aff4a;
            text-align: center;
            font-weight: bold;
            min-width: 300px;
          ">
            [OVERRIDE ACCEPTED]
          </div>
        ` },
        
        systemPopup(`
          <div style="color: #4a9eff; font-size: 0.75rem; margin-bottom: 0.5rem;">System Management</div>
          <div>New protocol generated.</div>
        `, false),
        
        // Cost: Everything
        systemPopup(`
          <div style="margin: 0.5rem 0;">Option: <span style="color: #ffcc00;">Rebirth</span></div>
          <div style="margin: 0.5rem 0;">Cost: <span style="color: #ff4a4a;">Everything.</span></div>
          <div style="margin: 0.75rem 0;">Accept?</div>
          <div style="display: flex; gap: 0.75rem; margin-top: 0.75rem;">
            <span style="border: 1px solid #4aff4a; padding: 0.2rem 0.75rem; color: #4aff4a;">[YES]</span>
            <span style="border: 1px solid #4aff4a; padding: 0.2rem 0.75rem; color: #4aff4a;">[YES]</span>
          </div>
        `, false),
        
        systemPopup(`
          <div style="color: #4a9eff; font-size: 0.75rem; margin-bottom: 0.5rem;">System Management</div>
          <div>Response received: <span style="color: #4aff4a;">[YES]</span></div>
        `, false),
        
        // Granted
        systemPopup(`
          <div style="margin: 0.5rem 0; font-size: 1rem;">Request: <span style="color: #4aff4a;">GRANTED.</span></div>
          <div style="margin: 0.5rem 0;">Passengers: <span style="color: #ffcc00;">2</span></div>
          <div style="margin: 0.75rem 0;">Rebirth will commence.</div>
          <div style="margin: 0.75rem 0 0.5rem; border-top: 1px solid #333; padding-top: 0.5rem;">Destination: <span style="color: #444;">████-██-██</span></div>
          <div style="margin: 0.3rem 0;">Remaining Survivors: <span style="color: #ffcc00;">1</span></div>
        `, false),
        
        { type: 'html', content: `<div style="font-family: monospace; color: #4a9eff; padding: 1rem;">Processing…</div>` },
        
        systemPopup(`<div>Remaining Survivors: <span style="color: #ffcc00;">1</span></div>`, false),
        systemPopup(`<div>Remaining Survivors: <span style="color: #ffcc00;">1</span></div>`, false),
        systemPopup(`<div>Remaining Survivors: <span style="color: #ffcc00;">1</span></div>`, false),
        
        glitchPopup(`
          <div style="color: #666; font-size: 0.85rem;">System</div>
          <div>Remaining Survivor s: <span style="color: #ff4a4a;">0</span></div>
        `),
        
        glitchPopup(`
          Remai__(n)i ng Su rvivo rs: <span style="color: #4aff4a;">2</span><br>
          Re mani ng
        `),
        
        glitchPopup(`Errror: unekspec ted variab l`),
        
        glitchPopup(`osmethi ng is wr on g`),
        
        { type: 'html', content: `
          <div style="
            font-family: monospace;
            background: linear-gradient(135deg, #0a0a15 0%, #0d0d18 100%);
            border: 1px solid #4a9eff;
            padding: 1.5rem;
            color: #7eb8ff;
            text-align: center;
            line-height: 1.8;
            min-width: 200px;
          ">
            <div>i a m</div>
            <div>i</div>
            <div>w ho</div>
            <div>?</div>
          </div>
        ` },
        
        // Final
        { type: 'html', content: `
          <div style="
            font-family: monospace;
            background: #000;
            border: 1px solid #333;
            padding: 1.5rem;
            color: #555;
            text-align: center;
            min-width: 300px;
          ">
            [SYSTEM MANAGEMENT HAS BEEN TEMPORARILY SUSPENDED]
          </div>
        ` }
      ];

      // Start the sequence
      PopupSystem.sequence.start(sequence, function() {
        // Show end content and header
        document.querySelector('.site-header').classList.add('is-visible');
        document.getElementById('chapter-end').classList.add('is-visible');
      });
    });
  </script>
</body>
</html>

