/* ============================================================
   BASE.CSS - Core Styles & Theme System
   ============================================================
   This file contains:
   - CSS Custom Properties (variables) for easy theming
   - Dark/Light mode definitions
   - Base typography and spacing
   - Font size scaling system
   ============================================================ */

/* ------------------------------------------------------------
   CSS CUSTOM PROPERTIES (Variables)
   ------------------------------------------------------------
   These variables control colors throughout the entire site.
   By changing these values, you change the whole look.
   The "light theme" is default; dark theme overrides below.
   ------------------------------------------------------------ */

:root {
  /* === LIGHT THEME COLORS (Default) === */
  
  /* Main backgrounds */
  --color-bg-primary: #fefefe;
  --color-bg-secondary: #f5f5f5;
  --color-bg-tertiary: #e8e8e8;
  
  /* Text colors */
  --color-text-primary: #1a1a1a;
  --color-text-secondary: #4a4a4a;
  --color-text-muted: #777777;
  
  /* Accent colors - adjust to match your story's mood */
  --color-accent: #5c6bc0;
  --color-accent-hover: #3f51b5;
  --color-accent-subtle: rgba(92, 107, 192, 0.1);
  
  /* UI elements */
  --color-border: #ddd;
  --color-border-strong: #bbb;
  --color-shadow: rgba(0, 0, 0, 0.1);
  --color-shadow-strong: rgba(0, 0, 0, 0.2);
  
  /* Overlay/popup backgrounds */
  --color-overlay-backdrop: rgba(0, 0, 0, 0.6);
  --color-overlay-bg: #ffffff;
  
  /* System popup specific (for LitRPG system messages) */
  --color-system-bg: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  --color-system-border: #4a9eff;
  --color-system-text: #e0e0e0;
  --color-system-glow: rgba(74, 158, 255, 0.4);

  /* === TYPOGRAPHY === */
  
  /* Font families - using system fonts for fast loading */
  --font-prose: 'Georgia', 'Times New Roman', serif;
  --font-ui: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  --font-mono: 'Consolas', 'Monaco', 'Courier New', monospace;
  
  /* Base font size - this is what everything scales from */
  --font-size-base: 18px;
  
  /* Font size scale multiplier - changed by user settings */
  --font-scale: 1;
  
  /* Line height for comfortable reading */
  --line-height-prose: 1.8;
  --line-height-ui: 1.5;
  
  /* === SPACING === */
  --spacing-xs: 0.25rem;
  --spacing-sm: 0.5rem;
  --spacing-md: 1rem;
  --spacing-lg: 2rem;
  --spacing-xl: 4rem;
  
  /* Maximum content width for readability */
  --content-max-width: 720px;
  --content-wide-max-width: 900px;
  
  /* === TRANSITIONS === */
  --transition-fast: 150ms ease;
  --transition-normal: 300ms ease;
  --transition-slow: 500ms ease;
}

/* ------------------------------------------------------------
   DARK THEME
   ------------------------------------------------------------
   Applied when <html data-theme="dark"> or user prefers dark.
   We only override the color variables; everything else stays.
   ------------------------------------------------------------ */

[data-theme="dark"] {
  --color-bg-primary: #121212;
  --color-bg-secondary: #1e1e1e;
  --color-bg-tertiary: #2a2a2a;
  
  --color-text-primary: #e8e8e8;
  --color-text-secondary: #b0b0b0;
  --color-text-muted: #808080;
  
  --color-accent: #7c8adb;
  --color-accent-hover: #9fa8e8;
  --color-accent-subtle: rgba(124, 138, 219, 0.15);
  
  --color-border: #333;
  --color-border-strong: #444;
  --color-shadow: rgba(0, 0, 0, 0.3);
  --color-shadow-strong: rgba(0, 0, 0, 0.5);
  
  --color-overlay-backdrop: rgba(0, 0, 0, 0.8);
  --color-overlay-bg: #1e1e1e;
  
  /* System popups look great in dark mode already */
  --color-system-bg: linear-gradient(135deg, #0a0a15 0%, #101020 100%);
  --color-system-glow: rgba(74, 158, 255, 0.6);
}

/* Respect user's OS preference if no explicit theme set */
@media (prefers-color-scheme: dark) {
  :root:not([data-theme="light"]) {
    --color-bg-primary: #121212;
    --color-bg-secondary: #1e1e1e;
    --color-bg-tertiary: #2a2a2a;
    --color-text-primary: #e8e8e8;
    --color-text-secondary: #b0b0b0;
    --color-text-muted: #808080;
    --color-accent: #7c8adb;
    --color-accent-hover: #9fa8e8;
    --color-accent-subtle: rgba(124, 138, 219, 0.15);
    --color-border: #333;
    --color-border-strong: #444;
    --color-shadow: rgba(0, 0, 0, 0.3);
    --color-shadow-strong: rgba(0, 0, 0, 0.5);
    --color-overlay-backdrop: rgba(0, 0, 0, 0.8);
    --color-overlay-bg: #1e1e1e;
    --color-system-bg: linear-gradient(135deg, #0a0a15 0%, #101020 100%);
    --color-system-glow: rgba(74, 158, 255, 0.6);
  }
}

/* ------------------------------------------------------------
   FONT SIZE SCALING
   ------------------------------------------------------------
   Users can adjust font size. The --font-scale variable
   is set by JavaScript; these classes are fallbacks.
   ------------------------------------------------------------ */

[data-font-size="small"] {
  --font-scale: 0.85;
}

[data-font-size="normal"] {
  --font-scale: 1;
}

[data-font-size="large"] {
  --font-scale: 1.15;
}

[data-font-size="x-large"] {
  --font-scale: 1.3;
}

/* ------------------------------------------------------------
   CSS RESET & BASE STYLES
   ------------------------------------------------------------ */

*, *::before, *::after {
  box-sizing: border-box;
}

* {
  margin: 0;
  padding: 0;
}

html {
  /* Smooth scrolling for anchor links */
  scroll-behavior: smooth;
  
  /* Prevent text size adjustment on mobile orientation change */
  -webkit-text-size-adjust: 100%;
}

body {
  font-family: var(--font-ui);
  font-size: calc(var(--font-size-base) * var(--font-scale));
  line-height: var(--line-height-ui);
  color: var(--color-text-primary);
  background-color: var(--color-bg-primary);
  
  /* Smooth color transitions when switching themes */
  transition: 
    background-color var(--transition-normal),
    color var(--transition-normal);
  
  /* Improve text rendering */
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* ------------------------------------------------------------
   BASE TYPOGRAPHY
   ------------------------------------------------------------ */

h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-ui);
  font-weight: 600;
  line-height: 1.3;
  color: var(--color-text-primary);
}

h1 { font-size: calc(2rem * var(--font-scale)); }
h2 { font-size: calc(1.5rem * var(--font-scale)); }
h3 { font-size: calc(1.25rem * var(--font-scale)); }
h4 { font-size: calc(1.1rem * var(--font-scale)); }

p {
  margin-bottom: var(--spacing-md);
}

a {
  color: var(--color-accent);
  text-decoration: none;
  transition: color var(--transition-fast);
}

a:hover {
  color: var(--color-accent-hover);
  text-decoration: underline;
}

/* Focus styles for accessibility */
a:focus-visible,
button:focus-visible {
  outline: 2px solid var(--color-accent);
  outline-offset: 2px;
}

/* ------------------------------------------------------------
   UTILITY CLASSES
   ------------------------------------------------------------ */

.visually-hidden {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

.text-center { text-align: center; }
.text-muted { color: var(--color-text-muted); }

/* Reduced motion preference - disable animations */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
  
  html {
    scroll-behavior: auto;
  }
}
